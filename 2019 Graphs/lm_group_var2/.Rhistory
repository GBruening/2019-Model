ggplot(rsq_frame,aes(fill=factor(minfunc),x=variable,y=rsquared))+
geom_bar(position='dodge',stat='identity')+
theme_classic(base_family='Times')+
theme(axis.text.x = element_text(angle = 45, hjust = 1))+#,axis.line = element_line(color='black',size = 1,linetype='solid'))+
scale_x_discrete(labels=parse(text=fitting_labs))+
labs(x='Fitted Variable',y='R Squared Value',fill=minparams)+
guides(fill=guide_legend(title="Minimization\nFunction"))+
scale_fill_manual(labels = parse(text = min_labs), values = colorRampPalette(brewer.pal(9,"Spectral"))(9))
setwd(paste(parent_fold,'/2019 Graphs',sep=''))
ggsave('Rsq_matrix_expo1.pdf', useDingbats = FALSE,width=7,height=4.5,units='in')
}
rsq_frame = data.frame(minfunc = minfuncs_rsq,variable=vars_rsq,expo = expo_rsq,rsquared = rsq)
rsq_frame$variable = factor(rsq_frame$variable,
levels = (1:13),
labels = c(1,7,2,8,3,9,4,10,5,11,6,12,13))
min_labs = c(TeX('Stress $(N/m^2)$'),
TeX('$Stress^2$ $(N/m^2)^2$'),
TeX('Force $(N)$'),
TeX('$Force^2$ $(N^2)$'),
TeX('Active State$'),
TeX('Active $State^2$'),
TeX('Neural Drive'),
TeX('Neural $Drive^2$'),
TeX('Energy Model $(W)$'))
fitting_labs = c(TeX('Torque (Nm)'),
TeX('$Torque^2$ $(Nm)^2$'),
TeX('Output Force $(N)$'),
TeX('$Output Force^2$ $(N)$'),
TeX('Muscle Force $(N)$'),
TeX('$Muscle Force^2$ $(N^2)$'),
TeX('Stress $(N/m^2)$'),
TeX('$Stress^2$ $(N/m^2)^2$'),
TeX('Active State$'),
TeX('Active $State^2$'),
TeX('Neural Drive'),
TeX('Neural $Drive^2$'),
TeX('Energy Model $(W)$'))
if (do_linfit_plots){
ggplot(rsq_frame,aes(fill=factor(minfunc),x=reorder(variable),y=rsquared))+
geom_bar(position='dodge',stat='identity')+
theme_classic(base_family='Times')+
theme(axis.text.x = element_text(angle = 45, hjust = 1))+#,axis.line = element_line(color='black',size = 1,linetype='solid'))+
scale_x_discrete(labels=parse(text=fitting_labs))+
labs(x='Fitted Variable',y='R Squared Value',fill=minparams)+
guides(fill=guide_legend(title="Minimization\nFunction"))+
scale_fill_manual(labels = parse(text = min_labs), values = colorRampPalette(brewer.pal(9,"Spectral"))(9))}
ggplot(rsq_frame,aes(fill=factor(minfunc),x=variable,y=rsquared))+
geom_bar(position='dodge',stat='identity')+
theme_classic(base_family='Times')+
theme(axis.text.x = element_text(angle = 45, hjust = 1))+#,axis.line = element_line(color='black',size = 1,linetype='solid'))+
scale_x_discrete(labels=parse(text=fitting_labs))+
labs(x='Fitted Variable',y='R Squared Value',fill=minparams)+
guides(fill=guide_legend(title="Minimization\nFunction"))+
scale_fill_manual(labels = parse(text = min_labs), values = colorRampPalette(brewer.pal(9,"Spectral"))(9))
rsq_frame
gplot(rsq_frame,aes(fill=factor(minfunc),x=reorder(variable,variable),y=rsquared))+
geom_bar(position='dodge',stat='identity')+
theme_classic(base_family='Times')+
theme(axis.text.x = element_text(angle = 45, hjust = 1))+#,axis.line = element_line(color='black',size = 1,linetype='solid'))+
scale_x_discrete(labels=parse(text=fitting_labs))+
labs(x='Fitted Variable',y='R Squared Value',fill=minparams)+
guides(fill=guide_legend(title="Minimization\nFunction"))+
scale_fill_manual(labels = parse(text = min_labs), values = colorRampPalette(brewer.pal(9,"Spectral"))(9))
ggplot(rsq_frame,aes(fill=factor(minfunc),x=reorder(variable,variable),y=rsquared))+
geom_bar(position='dodge',stat='identity')+
theme_classic(base_family='Times')+
theme(axis.text.x = element_text(angle = 45, hjust = 1))+#,axis.line = element_line(color='black',size = 1,linetype='solid'))+
scale_x_discrete(labels=parse(text=fitting_labs))+
labs(x='Fitted Variable',y='R Squared Value',fill=minparams)+
guides(fill=guide_legend(title="Minimization\nFunction"))+
scale_fill_manual(labels = parse(text = min_labs), values = colorRampPalette(brewer.pal(9,"Spectral"))(9))
warnings()
ggplot(rsq_frame,aes(fill=factor(minfunc),x=factor(variable),y=rsquared))+
geom_bar(position='dodge',stat='identity')+
theme_classic(base_family='Times')+
theme(axis.text.x = element_text(angle = 45, hjust = 1))+#,axis.line = element_line(color='black',size = 1,linetype='solid'))+
scale_x_discrete(labels=parse(text=fitting_labs))+
labs(x='Fitted Variable',y='R Squared Value',fill=minparams)+
guides(fill=guide_legend(title="Minimization\nFunction"))+
scale_fill_manual(labels = parse(text = min_labs), values = colorRampPalette(brewer.pal(9,"Spectral"))(9))
ggplot(rsq_frame,aes(fill=factor(minfunc),x=reorder(variable,variable),y=rsquared))+
geom_bar(stat='identity')+
theme_classic(base_family='Times')+
theme(axis.text.x = element_text(angle = 45, hjust = 1))+#,axis.line = element_line(color='black',size = 1,linetype='solid'))+
scale_x_discrete(labels=parse(text=fitting_labs))+
labs(x='Fitted Variable',y='R Squared Value',fill=minparams)+
guides(fill=guide_legend(title="Minimization\nFunction"))+
scale_fill_manual(labels = parse(text = min_labs), values = colorRampPalette(brewer.pal(9,"Spectral"))(9))
position='dodge',
ggplot(rsq_frame,aes(fill=factor(minfunc),x=reorder(variable,variable),y=rsquared))+
geom_bar(position='dodge',stat='identity')+
theme_classic(base_family='Times')+
theme(axis.text.x = element_text(angle = 45, hjust = 1))+#,axis.line = element_line(color='black',size = 1,linetype='solid'))+
scale_x_discrete(labels=parse(text=fitting_labs))+
labs(x='Fitted Variable',y='R Squared Value',fill=minparams)+
guides(fill=guide_legend(title="Minimization\nFunction"))+
scale_fill_manual(labels = parse(text = min_labs), values = colorRampPalette(brewer.pal(9,"Spectral"))(9))
rsq_frame
ggplot(rsq_frame,aes(fill=factor(minfunc),x=reorder(variable,variable),y=rsquared))+
geom_bar(position='dodge',stat='identity')+
theme_classic(base_family='Times')+
theme(axis.text.x = element_text(angle = 45, hjust = 1))+#,axis.line = element_line(color='black',size = 1,linetype='solid'))+
scale_x_discrete(breaks = variable,labels=parse(text=fitting_labs))+
labs(x='Fitted Variable',y='R Squared Value',fill=minparams)+
guides(fill=guide_legend(title="Minimization\nFunction"))+
scale_fill_manual(labels = parse(text = min_labs), values = colorRampPalette(brewer.pal(9,"Spectral"))(9))
ggplot(rsq_frame,aes(fill=factor(minfunc),x=reorder(variable,variable),y=rsquared))+
geom_bar(position='dodge',stat='identity')+
theme_classic(base_family='Times')+
theme(axis.text.x = element_text(angle = 45, hjust = 1))+#,axis.line = element_line(color='black',size = 1,linetype='solid'))+
scale_x_discrete(breaks = c(1,7,2,8,3,9,4,10,5,11,6,12,13),labels=parse(text=fitting_labs))+
labs(x='Fitted Variable',y='R Squared Value',fill=minparams)+
guides(fill=guide_legend(title="Minimization\nFunction"))+
scale_fill_manual(labels = parse(text = min_labs), values = colorRampPalette(brewer.pal(9,"Spectral"))(9))
ggplot(rsq_frame,aes(fill=factor(minfunc),x=reorder(variable,rsquared),y=rsquared))+
geom_bar(position='dodge',stat='identity')+
theme_classic(base_family='Times')+
theme(axis.text.x = element_text(angle = 45, hjust = 1))+#,axis.line = element_line(color='black',size = 1,linetype='solid'))+
scale_x_discrete(labels=parse(text=fitting_labs))+
labs(x='Fitted Variable',y='R Squared Value',fill=minparams)+
guides(fill=guide_legend(title="Minimization\nFunction"))+
scale_fill_manual(labels = parse(text = min_labs), values = colorRampPalette(brewer.pal(9,"Spectral"))(9))
variable
ggplot(rsq_frame,aes(fill=factor(minfunc),x=reorder(variable,variable),y=rsquared))+
geom_bar(position='dodge',stat='identity')+
theme_classic(base_family='Times')+
theme(axis.text.x = element_text(angle = 45, hjust = 1))+#,axis.line = element_line(color='black',size = 1,linetype='solid'))+
scale_x_discrete(labels=parse(text=fitting_labs))+
labs(x='Fitted Variable',y='R Squared Value',fill=minparams)+
guides(fill=guide_legend(title="Minimization\nFunction"))+
scale_fill_manual(labels = parse(text = min_labs), values = colorRampPalette(brewer.pal(9,"Spectral"))(9))
c(1,7,2,8,3,9,4,10,5,11,6,12,13)
rsq_frame = data.frame(minfunc = minfuncs_rsq,variable=vars_rsq,expo = expo_rsq,rsquared = rsq)
rsq_frame
ggplot(rsq_frame,aes(fill=factor(minfunc),x=reorder(variable,variable),y=rsquared))+
geom_bar(position='dodge',stat='identity')+
theme_classic(base_family='Times')+
theme(axis.text.x = element_text(angle = 45, hjust = 1))+#,axis.line = element_line(color='black',size = 1,linetype='solid'))+
scale_x_discrete(labels=parse(text=fitting_labs))+
labs(x='Fitted Variable',y='R Squared Value',fill=minparams)+
guides(fill=guide_legend(title="Minimization\nFunction"))+
scale_fill_manual(labels = parse(text = min_labs), values = colorRampPalette(brewer.pal(9,"Spectral"))(9))
rsq_frame$variable = factor(rsq_frame$variable,
levels = (1:13),
labels = c(1,7,2,8,3,9,4,10,5,11,6,12,13))
rsq_frame
ggplot(rsq_frame,aes(fill=factor(minfunc),x=reorder(variable,variable),y=rsquared))+
geom_bar(position='dodge',stat='identity')+
theme_classic(base_family='Times')+
theme(axis.text.x = element_text(angle = 45, hjust = 1))+#,axis.line = element_line(color='black',size = 1,linetype='solid'))+
scale_x_discrete(labels=parse(text=fitting_labs))+
labs(x='Fitted Variable',y='R Squared Value',fill=minparams)+
guides(fill=guide_legend(title="Minimization\nFunction"))+
scale_fill_manual(labels = parse(text = min_labs), values = colorRampPalette(brewer.pal(9,"Spectral"))(9))
ggplot(rsq_frame,aes(fill=factor(minfunc),x=variable,y=rsquared))+
geom_bar(position='dodge',stat='identity')
ggplot(rsq_frame,aes(fill=factor(minfunc),x=variable,y=rsquared))+
geom_bar(position='dodge',stat='identity')+
theme_classic(base_family='Times')+
theme(axis.text.x = element_text(angle = 45, hjust = 1))+#,axis.line = element_line(color='black',size = 1,linetype='solid'))+
scale_x_discrete(breaks = (1:13), labels=parse(text=fitting_labs))+
labs(x='Fitted Variable',y='R Squared Value',fill=minparams)+
guides(fill=guide_legend(title="Minimization\nFunction"))+
scale_fill_manual(labels = parse(text = min_labs), values = colorRampPalette(brewer.pal(9,"Spectral"))(9))
(1:13)
ggplot(rsq_frame,aes(fill=factor(minfunc),x=variable,y=rsquared))+
geom_bar(position='dodge',stat='identity')+
theme_classic(base_family='Times')+
theme(axis.text.x = element_text(angle = 45, hjust = 1))+#,axis.line = element_line(color='black',size = 1,linetype='solid'))+
scale_x_discrete(breaks = (1:13), labels=parse(text=fitting_labs))
ggplot(rsq_frame,aes(fill=factor(minfunc),x=variable,y=rsquared))+
geom_bar(position='dodge',stat='identity')+
theme_classic(base_family='Times')+
theme(axis.text.x = element_text(angle = 45, hjust = 1))+#,axis.line = element_line(color='black',size = 1,linetype='solid'))+
scale_x_discrete(breaks = (1:13))
rsq_frame$variable = as.numeric(rsq_frame$variable)
ggplot(rsq_frame,aes(fill=factor(minfunc),x=variable,y=rsquared))+
geom_bar(position='dodge',stat='identity')+
theme_classic(base_family='Times')+
theme(axis.text.x = element_text(angle = 45, hjust = 1))+#,axis.line = element_line(color='black',size = 1,linetype='solid'))+
scale_x_discrete(breaks = (1:13))
ggplot(rsq_frame,aes(fill=factor(minfunc),x=variable,y=rsquared))+
geom_bar(position='dodge',stat='identity')+
theme_classic(base_family='Times')+
theme(axis.text.x = element_text(angle = 45, hjust = 1))
rsq_frame
rsq_frame = data.frame(minfunc = minfuncs_rsq,variable=vars_rsq,expo = expo_rsq,rsquared = rsq)
rsq_frame$variable = factor(rsq_frame$variable,
levels = (1:13),
labels = c(1,7,2,8,3,9,4,10,5,11,6,12,13))
rsq_frame$variable = as.numeric(rsq_frame$variable)
rsq_frame
rsq_frame$variable = factor(rsq_frame$variable,
levels = (1:13),
labels = c(1,7,2,8,3,9,4,10,5,11,6,12,13))
rsq_frame
ggplot(rsq_frame,aes(fill=factor(minfunc),x=variable,y=rsquared))+
geom_bar(position='dodge',stat='identity')
ggplot(rsq_frame,aes(fill=factor(minfunc),x=reorder(variable,variable),y=rsquared))+
geom_bar(position='dodge',stat='identity')
rsq_frame[order(variable)]
rsq_frame[order(rsq_frame$variable)]
rsq_frame[order(rsq_frame$variable),]
rsq_frame <- rsq_frame[order(rsq_frame$variable),]
ggplot(rsq_frame,aes(fill=factor(minfunc),x=reorder(variable,variable),y=rsquared))+
geom_bar(position='dodge',stat='identity')
rownames(rsq_frame) = NULL
ggplot(rsq_frame,aes(fill=factor(minfunc),x=reorder(variable,variable),y=rsquared))+
geom_bar(position='dodge',stat='identity')
rsq_frame = data.frame(minfunc = minfuncs_rsq,variable=vars_rsq,expo = expo_rsq,rsquared = rsq)
rsq_frame$variable = factor(rsq_frame$variable,
levels = (1:13),
labels = c(1,7,2,8,3,9,4,10,5,11,6,12,13))
ggplot(rsq_frame,aes(fill=factor(minfunc),x=reorder(variable,variable),y=rsquared))+
geom_bar(position=variable,stat='identity')
ggplot(rsq_frame,aes(fill=factor(minfunc),x=reorder(variable,variable),y=rsquared))+
geom_bar(position=rsq_frame$variable,stat='identity')
rsq_frame = data.frame(minfunc = minfuncs_rsq,variable=vars_rsq,expo = expo_rsq,rsquared = rsq)
ggplot(rsq_frame,aes(fill=factor(minfunc),x=reorder(variable,variable),y=rsquared))+
geom_bar(position='dodge',stat='identity')+
theme_classic(base_family='Times')+
theme(axis.text.x = element_text(angle = 45, hjust = 1))+#,axis.line = element_line(color='black',size = 1,linetype='solid'))+
scale_x_discrete(limits = (1:13), labels=parse(text=fitting_labs))
rsq_frame$variable = factor(rsq_frame$variable,
levels = (1:13),
labels = c(1,7,2,8,3,9,4,10,5,11,6,12,13))
ggplot(rsq_frame,aes(fill=factor(minfunc),x=reorder(variable,variable),y=rsquared))+
geom_bar(position='dodge',stat='identity')+
theme_classic(base_family='Times')+
theme(axis.text.x = element_text(angle = 45, hjust = 1))+#,axis.line = element_line(color='black',size = 1,linetype='solid'))+
scale_x_discrete(limits = (1:13), labels=parse(text=fitting_labs))
fitting_labs = c(TeX('Torque (Nm)'),
TeX('Output Force $(N)$'),
TeX('Muscle Force $(N)$'),
TeX('Stress $(N/m^2)$'),
TeX('Active State$'),
TeX('Neural Drive'),
TeX('$Torque^2$ $(Nm)^2$'),
TeX('$Output Force^2$ $(N)$'),
TeX('$Muscle Force^2$ $(N^2)$'),
TeX('$Stress^2$ $(N/m^2)^2$'),
TeX('Active $State^2$'),
TeX('Neural $Drive^2$'),
TeX('Energy Model $(W)$'))
ggplot(rsq_frame,aes(fill=factor(minfunc),x=reorder(variable,variable),y=rsquared))+
geom_bar(position='dodge',stat='identity')+
theme_classic(base_family='Times')+
theme(axis.text.x = element_text(angle = 45, hjust = 1))+#,axis.line = element_line(color='black',size = 1,linetype='solid'))+
scale_x_discrete(limits = (1:13), labels=parse(text=fitting_labs))+
labs(x='Fitted Variable',y='R Squared Value',fill=minparams)+
guides(fill=guide_legend(title="Minimization\nFunction"))+
scale_fill_manual(labels = parse(text = min_labs), values = colorRampPalette(brewer.pal(9,"Spectral"))(9))
rsq_frame = data.frame(minfunc = minfuncs_rsq,variable=vars_rsq,expo = expo_rsq,rsquared = rsq)
# rsq_frame$variable = as.numeric(rsq_frame$variable)
# rsq_frame <- rsq_frame[order(rsq_frame$variable),]
# rownames(rsq_frame) = NULL
min_labs = c(TeX('Stress $(N/m^2)$'),
TeX('$Stress^2$ $(N/m^2)^2$'),
TeX('Force $(N)$'),
TeX('$Force^2$ $(N^2)$'),
TeX('Active State$'),
TeX('Active $State^2$'),
TeX('Neural Drive'),
TeX('Neural $Drive^2$'),
TeX('Energy Model $(W)$'))
fitting_labs_split = c(TeX('Torque (Nm)'),
TeX('Output Force $(N)$'),
TeX('Muscle Force $(N)$'),
TeX('Stress $(N/m^2)$'),
TeX('Active State$'),
TeX('Neural Drive'),
TeX('$Torque^2$ $(Nm)^2$'),
TeX('$Output Force^2$ $(N)$'),
TeX('$Muscle Force^2$ $(N^2)$'),
TeX('$Stress^2$ $(N/m^2)^2$'),
TeX('Active $State^2$'),
TeX('Neural $Drive^2$'),
TeX('Energy Model $(W)$'))
fitting_labs = c(TeX('Torque (Nm)'),
TeX('$Torque^2$ $(Nm)^2$'),
TeX('Output Force $(N)$'),
TeX('$Output Force^2$ $(N)$'),
TeX('Muscle Force $(N)$'),
TeX('$Muscle Force^2$ $(N^2)$'),
TeX('Stress $(N/m^2)$'),
TeX('$Stress^2$ $(N/m^2)^2$'),
TeX('Active State$'),
TeX('Active $State^2$'),
TeX('Neural Drive'),
TeX('Neural $Drive^2$'),
TeX('Energy Model $(W)$'))
ggplot(rsq_frame,aes(fill=factor(minfunc),x=reorder(variable,variable),y=rsquared))+
geom_bar(position='dodge',stat='identity')+
theme_classic(base_family='Times')+
theme(axis.text.x = element_text(angle = 45, hjust = 1))+#,axis.line = element_line(color='black',size = 1,linetype='solid'))+
scale_x_discrete(limits = (1:13), labels=parse(text=fitting_labs_split))+
labs(x='Fitted Variable',y='R Squared Value',fill=minparams)+
guides(fill=guide_legend(title="Minimization\nFunction"))+
scale_fill_manual(labels = parse(text = min_labs), values = colorRampPalette(brewer.pal(9,"Spectral"))(9))
ggplot(rsq_frame,aes(fill=factor(minfunc),x=reorder(variable,variable),y=rsquared))+
geom_bar(position='dodge',stat='identity')+
theme_classic(base_family='Times')+
theme(axis.text.x = element_text(angle = 45, hjust = 1))+#,axis.line = element_line(color='black',size = 1,linetype='solid'))+
scale_x_discrete(limits = (1:13), labels=parse(text=fitting_labs))+
labs(x='Fitted Variable',y='R Squared Value',fill=minparams)+
guides(fill=guide_legend(title="Minimization\nFunction"))+
scale_fill_manual(labels = parse(text = min_labs), values = colorRampPalette(brewer.pal(9,"Spectral"))(9))
ggplot(rsq_frame,aes(fill=factor(minfunc),x=reorder(variable,variable),y=rsquared))+
geom_bar(position='dodge',stat='identity')+
theme_classic(base_family='Times')+
theme(axis.text.x = element_text(angle = 45, hjust = 1))+#,axis.line = element_line(color='black',size = 1,linetype='solid'))+
scale_x_discrete(limits = (1:13), labels=parse(text=fitting_labs))+
labs(x='Fitted Variable',y='R Squared Value',fill=minparams)+
guides(fill=guide_legend(title="Minimization\nFunction"))+
scale_fill_manual(labels = parse(text = min_labs), values = colorRampPalette(brewer.pal(9,"Spectral"))(9))
setwd(paste(parent_fold,'/2019 Graphs',sep=''))
ggsave('Rsq_matrix_expo1.pdf', useDingbats = FALSE,width=7,height=4.5,units='in')
rsq_frame$variable = factor(rsq_frame$variable,
levels = (1:13),
labels = c(1,7,2,8,3,9,4,10,5,11,6,12,13))
ggplot(rsq_frame,aes(fill=factor(minfunc),x=reorder(variable,variable),y=rsquared))+
geom_bar(position='dodge',stat='identity')+
theme_classic(base_family='Times')+
theme(axis.text.x = element_text(angle = 45, hjust = 1))+#,axis.line = element_line(color='black',size = 1,linetype='solid'))+
scale_x_discrete(limits = (1:13), labels=parse(text=fitting_labs_split))+
labs(x='Fitted Variable',y='R Squared Value',fill=minparams)+
guides(fill=guide_legend(title="Minimization\nFunction"))+
scale_fill_manual(labels = parse(text = min_labs), values = colorRampPalette(brewer.pal(9,"Spectral"))(9))
rsq_frame$variable = factor(rsq_frame$variable,
labels = (1:13),
levels = c(1,7,2,8,3,9,4,10,5,11,6,12,13))
setwd(paste(parent_fold,'/2019 Graphs',sep=''))
ggsave('Rsq_matrix_expo1_split.pdf', useDingbats = FALSE,width=7,height=4.5,units='in')
ggplot(rsq_frame,aes(fill=factor(minfunc),x=reorder(variable,variable),y=rsquared))+
geom_bar(position='dodge',stat='identity')+
theme_classic(base_family='Times')+
theme(axis.text.x = element_text(angle = 45, hjust = 1))+#,axis.line = element_line(color='black',size = 1,linetype='solid'))+
scale_x_discrete(limits = (1:13), labels=parse(text=fitting_labs))+
labs(x='Fitted Variable',y='R Squared Value',fill=minparams)+
guides(fill=guide_legend(title="Minimization\nFunction"))+
scale_fill_manual(labels = parse(text = min_labs), values = colorRampPalette(brewer.pal(9,"Spectral"))(9))+
theme_classic()
setwd(paste(parent_fold,'/2019 Graphs',sep=''))
ggsave('Rsq_matrix_expo1.pdf', useDingbats = FALSE,width=7,height=4.5,units='in')
rsq_frame$variable = factor(rsq_frame$variable,
levels = (1:13),
labels = c(1,7,2,8,3,9,4,10,5,11,6,12,13))
ggplot(rsq_frame,aes(fill=factor(minfunc),x=reorder(variable,variable),y=rsquared))+
geom_bar(position='dodge',stat='identity')+
theme_classic(base_family='Times')+
theme(axis.text.x = element_text(angle = 45, hjust = 1))+#,axis.line = element_line(color='black',size = 1,linetype='solid'))+
scale_x_discrete(limits = (1:13), labels=parse(text=fitting_labs_split))+
labs(x='Fitted Variable',y='R Squared Value',fill=minparams)+
guides(fill=guide_legend(title="Minimization\nFunction"))+
scale_fill_manual(labels = parse(text = min_labs), values = colorRampPalette(brewer.pal(9,"Spectral"))(9))+
theme_classic()
rsq_frame$variable = factor(rsq_frame$variable,
labels = (1:13),
levels = c(1,7,2,8,3,9,4,10,5,11,6,12,13))
setwd(paste(parent_fold,'/2019 Graphs',sep=''))
ggsave('Rsq_matrix_expo1_split.pdf', useDingbats = FALSE,width=7,height=4.5,units='in')
ggplot(rsq_frame,aes(fill=factor(minfunc),x=reorder(variable,variable),y=rsquared))+
geom_bar(position='dodge',stat='identity')+
theme_classic(base_family='Times')+
theme(axis.text.x = element_text(angle = 45, hjust = 1))+#,axis.line = element_line(color='black',size = 1,linetype='solid'))+
scale_x_discrete(limits = (1:13), labels=parse(text=fitting_labs))+
labs(x='Fitted Variable',y='R Squared Value',fill=minparams)+
guides(fill=guide_legend(title="Minimization\nFunction"))+
scale_fill_manual(labels = parse(text = min_labs), values = colorRampPalette(brewer.pal(9,"Spectral"))(9))
setwd(paste(parent_fold,'/2019 Graphs',sep=''))
ggsave('Rsq_matrix_expo1.pdf', useDingbats = FALSE,width=7,height=4.5,units='in')
rsq_frame$variable = factor(rsq_frame$variable,
levels = (1:13),
labels = c(1,7,2,8,3,9,4,10,5,11,6,12,13))
ggplot(rsq_frame,aes(fill=factor(minfunc),x=reorder(variable,variable),y=rsquared))+
geom_bar(position='dodge',stat='identity')+
theme_classic(base_family='Times')+
theme(axis.text.x = element_text(angle = 45, hjust = 1))+#,axis.line = element_line(color='black',size = 1,linetype='solid'))+
scale_x_discrete(limits = (1:13), labels=parse(text=fitting_labs_split))+
labs(x='Fitted Variable',y='R Squared Value',fill=minparams)+
guides(fill=guide_legend(title="Minimization\nFunction"))+
scale_fill_manual(labels = parse(text = min_labs), values = colorRampPalette(brewer.pal(9,"Spectral"))(9))
rsq_frame$variable = factor(rsq_frame$variable,
labels = (1:13),
levels = c(1,7,2,8,3,9,4,10,5,11,6,12,13))
setwd(paste(parent_fold,'/2019 Graphs',sep=''))
ggsave('Rsq_matrix_expo1_split.pdf', useDingbats = FALSE,width=7,height=4.5,units='in')
rsq_frame
rsq_frame[order(rsquared),]
rsq_frame[order(rsq_frame$rsquared),]
max(rsq_frame$rsquared)
filter(rsq_framem,rsquared = (max(rsq_frame$rsquared))$minfunc
)
filter(rsq_framem,rsquared = (max(rsq_frame$rsquared)))$minfunc
filter(rsq_frame,rsquared = (max(rsq_frame$rsquared)))$minfunc
filter(rsq_frame,rsquared == (max(rsq_frame$rsquared)))$minfunc
filter(rsq_frame,minfunc==filter(rsq_frame,rsquared == (max(rsq_frame$rsquared)))$minfunc)
best_min_func = filter(rsq_frame,rsquared == (max(rsq_frame$rsquared)))$minfunc
best_min_func
rsq_frame_filt = filter(rsq_frame,minfunc==filter(rsq_frame,rsquared == (max(rsq_frame$rsquared)))$minfunc)
ggplot(rsq_frame_filt,aes(x=variable),y=rsquared))+geom_bar(stat='identity')
ggplot(rsq_frame_filt,aes(x=variable,y=rsquared))+geom_bar(stat='identity')
ggplot(rsq_frame_filt,aes(x=variable,y=rsquared))+
geom_bar(stat='identity')+
theme_classic(base_family='Times')+
theme(axis.text.x = element_text(angle = 45, hjust = 1))+
scale_x_discrete(limits = (1:13), labels=parse(text=fitting_labs_split))+
labs(x='Fitted Variable',y='R Squared Value',fill=minparams)+
guides(fill=guide_legend(title="Minimization\nFunction"))+
scale_fill_manual(labels = parse(text = min_labs), values = colorRampPalette(brewer.pal(9,"Spectral"))(9))
ggplot(rsq_frame_filt,aes(x=variable,y=rsquared))+
geom_bar(stat='identity')
ggplot(rsq_frame_filt,aes(x=variable,y=rsquared))+
geom_bar(stat='identity')+
theme_classic(base_family='Times')+
theme(axis.text.x = element_text(angle = 45, hjust = 1))+
scale_x_discrete(limits = (1:13), labels=parse(text=fitting_labs_split))+
labs(x='Fitted Variable',y='R Squared Value',fill=minparams)+
guides(fill=guide_legend(title="Minimization\nFunction"))+
scale_fill_manual(labels = parse(text = min_labs), values = colorRampPalette(brewer.pal(9,"Spectral"))(9))
rsq_frame$variable = factor(rsq_frame$variable,
levels = (1:13),
labels = c(1,7,2,8,3,9,4,10,5,11,6,12,13))
ggplot(rsq_frame_filt,aes(x=variable,y=rsquared))+
geom_bar(stat='identity')+
theme_classic(base_family='Times')+
theme(axis.text.x = element_text(angle = 45, hjust = 1))+
scale_x_discrete(limits = (1:13), labels=parse(text=fitting_labs_split))+
labs(x='Fitted Variable',y='R Squared Value',fill=minparams)+
guides(fill=guide_legend(title="Minimization\nFunction"))+
scale_fill_manual(labels = parse(text = min_labs), values = colorRampPalette(brewer.pal(9,"Spectral"))(9))
rsq_frame$variable = factor(rsq_frame$variable,
labels = (1:13),
levels = c(1,7,2,8,3,9,4,10,5,11,6,12,13))
rsq_frame$variable = factor(rsq_frame$variable,
levels = (1:13),
labels = c(1,7,2,8,3,9,4,10,5,11,6,12,13))
ggplot(rsq_frame_filt,aes(x=variable,y=rsquared))+
geom_bar(stat='identity')+
theme_classic(base_family='Times')+
theme(axis.text.x = element_text(angle = 45, hjust = 1))+
scale_x_discrete(limits = (1:13), labels=parse(text=fitting_labs_split))+
labs(x='Fitted Variable',y='R Squared Value',fill=minparams)+
guides(fill=guide_legend(title="Minimization\nFunction"))+
scale_fill_manual(labels = parse(text = min_labs), values = colorRampPalette(brewer.pal(9,"Spectral"))(9))
rsq_frame_filt$variable = factor(rsq_frame_filt$variable,
levels = (1:13),
labels = c(1,7,2,8,3,9,4,10,5,11,6,12,13))
ggplot(rsq_frame_filt,aes(x=variable,y=rsquared))+
geom_bar(stat='identity')+
theme_classic(base_family='Times')+
theme(axis.text.x = element_text(angle = 45, hjust = 1))+
scale_x_discrete(limits = (1:13), labels=parse(text=fitting_labs_split))+
labs(x='Fitted Variable',y='R Squared Value',fill=minparams)+
guides(fill=guide_legend(title="Minimization\nFunction"))+
scale_fill_manual(labels = parse(text = min_labs), values = colorRampPalette(brewer.pal(9,"Spectral"))(9))
rsq_frame_filt$variable = factor(rsq_frame_filt$variable,
labels = (1:13),
levels = c(1,7,2,8,3,9,4,10,5,11,6,12,13))
best_min_func = filter(rsq_frame,rsquared == (max(rsq_frame$rsquared)))$minfunc
rsq_frame_filt = filter(rsq_frame,minfunc==filter(rsq_frame,rsquared == (max(rsq_frame$rsquared)))$minfunc)
ggplot(rsq_frame_filt,aes(x=variable,y=rsquared))+
geom_bar(stat='identity',fill='blue')+
theme_classic(base_family='Times')+
theme(axis.text.x = element_text(angle = 45, hjust = 1))+
scale_x_discrete(limits = (1:13), labels=parse(text=fitting_labs_split))+
labs(x='Fitted Variable',y='R Squared Value',fill=minparams)+
guides(fill=guide_legend(title="Minimization\nFunction"))+
scale_fill_manual(labels = parse(text = min_labs), values = colorRampPalette(brewer.pal(9,"Spectral"))(9))
ggplot(rsq_frame_filt,aes(x=variable,y=rsquared))+
geom_bar(stat='identity',fill='blue')+
theme_classic(base_family='Times')+
theme(axis.text.x = element_text(angle = 45, hjust = 1))+
scale_x_discrete(limits = (1:13), labels=parse(text=fitting_labs_split))+
labs(x='Fitted Variable',y='R Squared Value',fill=minparams)+
guides(fill=guide_legend(title="Minimization\nFunction"))+
scale_fill_manual(labels = parse(text = min_labs), values = colorRampPalette(brewer.pal(9,"Spectral"))(9))+
ylim(min(rsq_frame_filt$rsquared)*.95,max(rsq_frame_filt$rsquared)*1.05)
max(rsq_frame_filt$rsquared)
max(rsq_frame_filt$rsquared)*1.05\
max(rsq_frame_filt$rsquared)*1.05
ggplot(rsq_frame_filt,aes(x=variable,y=rsquared))+
geom_bar(stat='identity',fill='blue')+
theme_classic(base_family='Times')+
theme(axis.text.x = element_text(angle = 45, hjust = 1))+
scale_x_discrete(limits = (1:13), labels=parse(text=fitting_labs_split))+
labs(x='Fitted Variable',y='R Squared Value',fill=minparams)+
guides(fill=guide_legend(title="Minimization\nFunction"))+
scale_fill_manual(labels = parse(text = min_labs), values = colorRampPalette(brewer.pal(9,"Spectral"))(9))+
# ylim(min(rsq_frame_filt$rsquared)*.95,max(rsq_frame_filt$rsquared)*1.05)
ylim(0,1)
source('D:/Users/Gary/Google Drive/2019 Model/testing.R', echo=TRUE)
ggplot(rsq_frame_filt,aes(x=variable,y=rsquared))+
geom_bar(stat='identity',fill='blue')+
theme_classic(base_family='Times')+
theme(axis.text.x = element_text(angle = 45, hjust = 1))+
scale_x_discrete(limits = (1:13), labels=parse(text=fitting_labs_split))+
labs(x='Fitted Variable',y='R Squared Value',fill=minparams)+
guides(fill=guide_legend(title="Minimization\nFunction"))+
scale_fill_manual(labels = parse(text = min_labs), values = colorRampPalette(brewer.pal(9,"Spectral"))(9))+
# ylim(min(rsq_frame_filt$rsquared)*.95,max(rsq_frame_filt$rsquared)*1.05)
ylim(.4,.7)
ggplot(rsq_frame_filt,aes(x=variable,y=rsquared))+
geom_bar(stat='identity',fill='blue')+
theme_classic(base_family='Times')+
theme(axis.text.x = element_text(angle = 45, hjust = 1))+
scale_x_discrete(limits = (1:13), labels=parse(text=fitting_labs_split))+
labs(x='Fitted Variable',y='R Squared Value',fill=minparams)+
guides(fill=guide_legend(title="Minimization\nFunction"))+
scale_fill_manual(labels = parse(text = min_labs), values = colorRampPalette(brewer.pal(9,"Spectral"))(9))+
# ylim(min(rsq_frame_filt$rsquared)*.95,max(rsq_frame_filt$rsquared)*1.05)
ylim(.4,.7)
